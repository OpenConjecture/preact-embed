{"version":3,"sources":["../src/lite.ts"],"names":["cc","s","_","l","pv","v","n","gp","el","d","p","i","a","habitat","W","opts","selector","defaultProps","clean","els","instances","props","render","h"],"mappings":";AAcA,IAAMA,CAAAA,CAAMC,CAAAA,EAAcA,CAAAA,CAAE,OAAA,CAAQ,YAAA,CAAc,CAACC,CAAAA,CAAGC,CAAAA,GAAMA,EAAE,WAAA,EAAa,EAKrEC,CAAAA,CAAMC,CAAAA,EAAuB,CACjC,GAAIA,CAAAA,GAAM,MAAA,CAAQ,OAAO,KAAA,CACzB,GAAIA,IAAM,OAAA,CAAS,OAAO,OAC1B,GAAIA,CAAAA,GAAM,MAAA,CAAQ,OAAO,IAAA,CACzB,IAAMC,EAAI,MAAA,CAAOD,CAAC,EAClB,GAAI,CAAC,MAAMC,CAAC,CAAA,EAAKD,CAAAA,GAAM,EAAA,CAAI,OAAOC,CAAAA,CAClC,GAAI,CACF,OAAO,KAAK,KAAA,CAAMD,CAAC,CACrB,CAAA,KAAQ,CACN,OAAOA,CACT,CACF,CAAA,CAKME,EAAK,CAACC,CAAAA,CAAaC,EAAW,EAAC,GAAa,CAChD,IAAMC,CAAAA,CAAW,CAAE,GAAGD,CAAE,CAAA,CAGxB,QAASE,CAAAA,CAAI,CAAA,CAAGA,EAAIH,CAAAA,CAAG,UAAA,CAAW,OAAQG,CAAAA,EAAAA,CAAK,CAC7C,IAAMC,CAAAA,CAAIJ,CAAAA,CAAG,UAAA,CAAWG,CAAC,CAAA,CACrBC,CAAAA,CAAE,KAAK,UAAA,CAAW,YAAY,IAChCF,CAAAA,CAAEV,CAAAA,CAAGY,CAAAA,CAAE,IAAA,CAAK,KAAA,CAAM,EAAE,CAAC,CAAC,CAAA,CAAIR,EAAGQ,CAAAA,CAAE,KAAK,GAExC,CAGA,IAAMX,CAAAA,CAAIO,CAAAA,CAAG,aAAA,CAAc,2DAA2D,EACtF,GAAIP,CAAAA,CACF,GAAI,CACF,MAAA,CAAO,OAAOS,CAAAA,CAAG,IAAA,CAAK,KAAA,CAAMT,CAAAA,CAAE,SAAS,CAAC,EAC1C,CAAA,KAAQ,CAAC,CAGX,OAAOS,CACT,EAKe,SAARG,CAAAA,CAAkDC,CAAAA,CAAqB,CAC5E,OAAO,CACL,OAAOC,CAAAA,CAA0E,GAAI,CACnF,GAAM,CAAE,QAAA,CAAAC,CAAAA,CAAW,eAAA,CAAiB,YAAA,CAAAC,CAAAA,CAAc,KAAA,CAAAC,CAAM,CAAA,CAAIH,CAAAA,CACtDI,EAAM,QAAA,CAAS,gBAAA,CAAiBH,CAAQ,CAAA,CACxCI,CAAAA,CAAoD,EAAC,CAE3D,OAAAD,CAAAA,CAAI,QAASX,CAAAA,EAAO,CACdU,IAAOV,CAAAA,CAAG,SAAA,CAAY,IAC1B,IAAMa,CAAAA,CAAQd,CAAAA,CAAGC,CAAAA,CAAIS,CAAY,CAAA,CACjCK,cAAOC,QAAAA,CAAET,CAAAA,CAAGO,CAAK,CAAA,CAAGb,CAAE,EACtBY,CAAAA,CAAU,IAAA,CAAK,CACb,EAAA,CAAAZ,CAAAA,CACA,OAAA,CAAS,IAAMc,aAAAA,CAAO,IAAA,CAAMd,CAAE,CAChC,CAAC,EACH,CAAC,CAAA,CAEMY,CACT,CACF,CACF","file":"lite.cjs","sourcesContent":["/**\n * Preact Habitat Modern - Lite Version\n *\n * Ultra-lightweight (~500B) habitat for simple use cases.\n * Use the full version for Shadow DOM, Custom Elements, Signals, etc.\n */\n\nimport { h, render, ComponentType } from 'preact';\n\ntype Props = Record<string, unknown>;\n\n/**\n * Convert kebab-case to camelCase\n */\nconst cc = (s: string) => s.replace(/-([a-z])/gi, (_, l) => l.toUpperCase());\n\n/**\n * Parse a value from string to appropriate type\n */\nconst pv = (v: string): unknown => {\n  if (v === 'true') return true;\n  if (v === 'false') return false;\n  if (v === 'null') return null;\n  const n = Number(v);\n  if (!isNaN(n) && v !== '') return n;\n  try {\n    return JSON.parse(v);\n  } catch {\n    return v;\n  }\n};\n\n/**\n * Get props from element\n */\nconst gp = (el: Element, d: Props = {}): Props => {\n  const p: Props = { ...d };\n\n  // From data-prop-* attributes\n  for (let i = 0; i < el.attributes.length; i++) {\n    const a = el.attributes[i];\n    if (a.name.startsWith('data-prop-')) {\n      p[cc(a.name.slice(10))] = pv(a.value);\n    }\n  }\n\n  // From JSON script\n  const s = el.querySelector('script[type=\"application/json\"],script[type=\"text/props\"]');\n  if (s) {\n    try {\n      Object.assign(p, JSON.parse(s.innerHTML));\n    } catch {}\n  }\n\n  return p;\n};\n\n/**\n * Create a habitat for a component\n */\nexport default function habitat<P extends Props = Props>(W: ComponentType<P>) {\n  return {\n    render(opts: { selector?: string; defaultProps?: Partial<P>; clean?: boolean } = {}) {\n      const { selector = '[data-widget]', defaultProps, clean } = opts;\n      const els = document.querySelectorAll(selector);\n      const instances: { el: Element; unmount: () => void }[] = [];\n\n      els.forEach((el) => {\n        if (clean) el.innerHTML = '';\n        const props = gp(el, defaultProps) as P;\n        render(h(W, props), el);\n        instances.push({\n          el,\n          unmount: () => render(null, el),\n        });\n      });\n\n      return instances;\n    },\n  };\n}\n\nexport { h, render };\n"]}